<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="blase">
<title>BLASE on Simulated Data • blase</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="BLASE on Simulated Data">
<meta property="og:description" content="blase">
<meta property="og:image" content="https://andrewmccluskey-uog.github.io/BLASE/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">blase</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Vignettes</h6>
    <a class="dropdown-item" href="../articles/How-Blase-Works.html">How BLASE Works</a>
    <a class="dropdown-item" href="../articles/DE_with_blase.html">DE with Blase</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Verifying BLASE Works</h6>
    <a class="dropdown-item" href="../articles/compare_simulated_data.html">Simulated Data Workthrough</a>
    <a class="dropdown-item" href="../articles/assign-bulk-to-pseudotime.html">Assign SC Pseudobulks To SC Pseudotime</a>
    <a class="dropdown-item" href="../articles/BLASE-for-Hematopoesis.html">Weng 2024 Haematopoiesis</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Selecting Genes for Plasmodium sp.</h6>
    <a class="dropdown-item" href="../articles/gene_selection_comparison.html">Comparing Gene Selection Methods In Depth</a>
    <a class="dropdown-item" href="../articles/falciparum_lifecycle.html">P. Falciparum Lifecycle - Comparing Bozdech and TradeSeq</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Data Generation</h6>
    <a class="dropdown-item" href="../articles/data_generation/generate-MCA-pb-object.html">Malaria Cell Atlas PB</a>
    <a class="dropdown-item" href="../articles/data_generation/generate-MCA-pf-object.html">Malaria Cell Atlas PF</a>
    <a class="dropdown-item" href="../articles/data_generation/generate-weng-2024-haematopoiesis-object.html">Weng 2024 Haematopoiesis Test Dataset</a>
    <a class="dropdown-item" href="../articles/data_generation/generate-simulated-data-object.html">Simulation Data</a>
    <a class="dropdown-item" href="../articles/data_generation/generate-zhang-et-al-2021-bulk-FPKM-object.html">Generating Zhang et al. 2021 bulk FPKM Dataframe</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>BLASE on Simulated Data</h1>
            
      
      
      <div class="d-none name"><code>compare_simulated_data.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://andrewmccluskey-uog.github.io/BLASE/">blase</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">SingleCellExperiment</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://statomics.github.io/tradeSeq/index.html" class="external-link">tradeSeq</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">slingshot</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">scran</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://bioconductor.org/packages/scater/" class="external-link">scater</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Bioconductor/BiocParallel" class="external-link">BiocParallel</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dyngen.dynverse.org" class="external-link">dyngen</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">bluster</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://fs.r-lib.org" class="external-link">fs</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">utils</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">RNGversion</a></span><span class="op">(</span><span class="st">"3.5.0"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in RNGkind("Mersenne-Twister", "Inversion", "Rounding"): non-uniform</span></span>
<span><span class="co">#&gt; 'Rounding' sampler used</span></span>
<span><span class="va">SEED</span> <span class="op">=</span> <span class="fl">7</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">SEED</span><span class="op">)</span></span></code></pre></div>
<p>In this article, we’ll simulate a dataset, and show that BLASE works
well with it, mapping pseudobulked SC counts to the same SC data. We
split the simulated data in half and use one half of it as the
scRNA-seq, and the other for pseudobulking.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">N_CORES</span> <span class="op">=</span> <span class="fl">4</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu">ami</span><span class="fu">::</span><span class="fu"><a href="https://briandconnelly.github.io/ami/reference/ci.html" class="external-link">using_ci</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">N_CORES</span> <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="section level2">
<h2 id="get-the-simulation-data">Get the simulation data<a class="anchor" aria-label="anchor" href="#get-the-simulation-data"></a>
</h2>
<p>Steps to generate this data are available in <a href="articles/generate-simulated-data-object">generate-simulated-data-object</a>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">processed_simulated_data_SCE</span>, package<span class="op">=</span><span class="st">"blase"</span><span class="op">)</span></span></code></pre></div>
<p>Here we’ll set up the SCE and preprocess the data ready for
trajectory analysis. We show the <code>sim_time</code> mapped onto it,
which shows the true simulated trajectory.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">processed_simulated_data_SCE</span>, package<span class="op">=</span><span class="st">"blase"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/plotPCA.html" class="external-link">plotPCA</a></span><span class="op">(</span><span class="va">processed_simulated_data_SCE</span>, colour_by<span class="op">=</span><span class="st">"label"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/scater/man/plot_reddim.html" class="external-link">plotUMAP</a></span><span class="op">(</span><span class="va">processed_simulated_data_SCE</span>, colour_by<span class="op">=</span><span class="st">"label"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/plotPCA.html" class="external-link">plotPCA</a></span><span class="op">(</span><span class="va">processed_simulated_data_SCE</span>, colour_by<span class="op">=</span><span class="st">"sim_time"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/scater/man/plot_reddim.html" class="external-link">plotUMAP</a></span><span class="op">(</span><span class="va">processed_simulated_data_SCE</span>, colour_by<span class="op">=</span><span class="st">"sim_time"</span><span class="op">)</span>,</span>
<span>  ncol<span class="op">=</span><span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="compare_simulated_data_files/figure-html/clusterSCE-1.png" width="700"></p>
<p>The start cluster is labeled <code>4</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">START_CLUSTER</span> <span class="op">=</span> <span class="fl">4</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="split-datasets">Split Datasets<a class="anchor" aria-label="anchor" href="#split-datasets"></a>
</h2>
<p>We will now split the dataset so that the test dataset is unseen.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">processed_simulated_data_SCE</span><span class="op">$</span><span class="va">useAsBulk</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>n<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">processed_simulated_data_SCE</span><span class="op">)</span>, min<span class="op">=</span><span class="fl">0</span>, max<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span></span>
<span><span class="va">bulk_sce</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">processed_simulated_data_SCE</span>, , <span class="va">useAsBulk</span><span class="op">==</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">sc_sce</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">processed_simulated_data_SCE</span>, , <span class="va">useAsBulk</span><span class="op">==</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">processed_simulated_data_SCE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="sc-trajectory-analysis">SC Trajectory Analysis<a class="anchor" aria-label="anchor" href="#sc-trajectory-analysis"></a>
</h2>
<p>Now we’ll use slingshot to infer a trajectory, and tradeseq to
identify highly variable genes. We will compare the trajectory to the
simulated time below.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sc_sce</span></span>
<span><span class="co">#&gt; class: SingleCellExperiment </span></span>
<span><span class="co">#&gt; dim: 455 1030 </span></span>
<span><span class="co">#&gt; metadata(3): traj_milestone_network traj_progressions</span></span>
<span><span class="co">#&gt;   traj_dimred_segments</span></span>
<span><span class="co">#&gt; assays(6): counts logcounts ... counts_protein normcounts</span></span>
<span><span class="co">#&gt; rownames(455): M1_TF1 M2_TF1 ... HK49 HK50</span></span>
<span><span class="co">#&gt; rowData names(20): module_id basal ... mol_mrna mol_protein</span></span>
<span><span class="co">#&gt; colnames(1030): cell2 cell3 ... cell1996 cell1997</span></span>
<span><span class="co">#&gt; colData names(6): step_ix simulation_i ... label useAsBulk</span></span>
<span><span class="co">#&gt; reducedDimNames(3): MDS PCA UMAP</span></span>
<span><span class="co">#&gt; mainExpName: NULL</span></span>
<span><span class="co">#&gt; altExpNames(0):</span></span>
<span><span class="va">sc_sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/slingshot/man/slingshot.html" class="external-link">slingshot</a></span><span class="op">(</span><span class="va">sc_sce</span>, reducedDim <span class="op">=</span> <span class="st">'UMAP'</span>, clusterLabels<span class="op">=</span><span class="st">'label'</span>, start.clus<span class="op">=</span><span class="va">START_CLUSTER</span><span class="op">)</span></span>
<span><span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/plotPCA.html" class="external-link">plotPCA</a></span><span class="op">(</span><span class="va">sc_sce</span>, colour_by<span class="op">=</span><span class="st">"sim_time"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/plotPCA.html" class="external-link">plotPCA</a></span><span class="op">(</span><span class="va">sc_sce</span>, colour_by<span class="op">=</span><span class="st">"slingPseudotime_1"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/scater/man/plot_reddim.html" class="external-link">plotUMAP</a></span><span class="op">(</span><span class="va">sc_sce</span>, colour_by<span class="op">=</span><span class="st">"sim_time"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/scater/man/plot_reddim.html" class="external-link">plotUMAP</a></span><span class="op">(</span><span class="va">sc_sce</span>, colour_by<span class="op">=</span><span class="st">"slingPseudotime_1"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/plotPCA.html" class="external-link">plotPCA</a></span><span class="op">(</span><span class="va">sc_sce</span>, colour_by<span class="op">=</span><span class="st">"label"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/scater/man/plot_reddim.html" class="external-link">plotUMAP</a></span><span class="op">(</span><span class="va">sc_sce</span>, colour_by<span class="op">=</span><span class="st">"label"</span><span class="op">)</span>,</span>
<span>  ncol<span class="op">=</span><span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="compare_simulated_data_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sc_sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/tradeSeq/man/fitGAM.html" class="external-link">fitGAM</a></span><span class="op">(</span><span class="va">sc_sce</span>, parallel<span class="op">=</span><span class="cn">T</span>, BPPARAM<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/MulticoreParam-class.html" class="external-link">MulticoreParam</a></span><span class="op">(</span><span class="va">N_CORES</span><span class="op">)</span>, nknots<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">associationTestResult</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/tradeSeq/man/associationTest.html" class="external-link">associationTest</a></span><span class="op">(</span><span class="va">sc_sce</span>, lineages<span class="op">=</span><span class="cn">T</span>, global<span class="op">=</span><span class="cn">F</span>, contrastType<span class="op">=</span><span class="st">"consecutive"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="analyse-with-blase">Analyse with BLASE<a class="anchor" aria-label="anchor" href="#analyse-with-blase"></a>
</h2>
<p>We start by tuning the parameters for BLASE. See the <a href="articles/assign-bulk-to-pseudotime.html">vignette</a> for more
details.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">genelist</span> <span class="op">=</span> <span class="fu">blase</span><span class="fu">::</span><span class="fu"><a href="../reference/get_top_n_genes.html">get_top_n_genes</a></span><span class="op">(</span><span class="va">associationTestResult</span>, n_genes <span class="op">=</span> <span class="fl">200</span>, lineage <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">=</span> <span class="fu"><a href="../reference/find_best_params.html">find_best_params</a></span><span class="op">(</span><span class="va">sc_sce</span>,</span>
<span>                       <span class="va">genelist</span>,</span>
<span>                       split_by<span class="op">=</span><span class="st">"pseudotime_range"</span>,</span>
<span>                       pseudotime_slot<span class="op">=</span><span class="st">"slingPseudotime_1"</span>,</span>
<span>                       bins_count_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq.int</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">10</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>                       gene_count_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq.int</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">60</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_find_best_params_results.html">plot_find_best_params_results</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code></pre></div>
<p><img src="compare_simulated_data_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">genes</span> <span class="op">=</span> <span class="fl">30</span></span>
<span><span class="va">bins</span> <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="va">blaseData</span> <span class="op">=</span> <span class="fu"><a href="../reference/as.BlaseData.html">as.BlaseData</a></span><span class="op">(</span><span class="va">sc_sce</span>, pseudotime_slot<span class="op">=</span><span class="st">"slingPseudotime_1"</span>, n_bins<span class="op">=</span><span class="va">bins</span>, split_by<span class="op">=</span><span class="st">"pseudotime_range"</span><span class="op">)</span></span>
<span><span class="va">blaseData</span><span class="op">@</span><span class="va">genes</span> <span class="op">=</span> <span class="va">genelist</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">genes</span><span class="op">]</span></span>
<span><span class="fu"><a href="../reference/evaluate_parameters.html">evaluate_parameters</a></span><span class="op">(</span><span class="va">blaseData</span>, make_plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="compare_simulated_data_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; [1] 0.06590 0.14024</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="prepare-bulk">Prepare Bulk<a class="anchor" aria-label="anchor" href="#prepare-bulk"></a>
</h2>
<p>Here we set up the same trajectory with the bulk dataset, and split
it into separate “bulk” counts.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bulk_sce</span></span>
<span><span class="co">#&gt; class: SingleCellExperiment </span></span>
<span><span class="co">#&gt; dim: 455 970 </span></span>
<span><span class="co">#&gt; metadata(3): traj_milestone_network traj_progressions</span></span>
<span><span class="co">#&gt;   traj_dimred_segments</span></span>
<span><span class="co">#&gt; assays(6): counts logcounts ... counts_protein normcounts</span></span>
<span><span class="co">#&gt; rownames(455): M1_TF1 M2_TF1 ... HK49 HK50</span></span>
<span><span class="co">#&gt; rowData names(20): module_id basal ... mol_mrna mol_protein</span></span>
<span><span class="co">#&gt; colnames(970): cell1 cell6 ... cell1999 cell2000</span></span>
<span><span class="co">#&gt; colData names(6): step_ix simulation_i ... label useAsBulk</span></span>
<span><span class="co">#&gt; reducedDimNames(3): MDS PCA UMAP</span></span>
<span><span class="co">#&gt; mainExpName: NULL</span></span>
<span><span class="co">#&gt; altExpNames(0):</span></span>
<span></span>
<span><span class="va">bulk_sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/slingshot/man/slingshot.html" class="external-link">slingshot</a></span><span class="op">(</span><span class="va">bulk_sce</span>, reducedDim <span class="op">=</span> <span class="st">'UMAP'</span>, clusterLabels<span class="op">=</span><span class="st">'label'</span>, start.clus<span class="op">=</span><span class="va">START_CLUSTER</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/plotPCA.html" class="external-link">plotPCA</a></span><span class="op">(</span><span class="va">bulk_sce</span>, colour_by<span class="op">=</span><span class="st">"sim_time"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/plotPCA.html" class="external-link">plotPCA</a></span><span class="op">(</span><span class="va">bulk_sce</span>, colour_by<span class="op">=</span><span class="st">"slingPseudotime_1"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/scater/man/plot_reddim.html" class="external-link">plotUMAP</a></span><span class="op">(</span><span class="va">bulk_sce</span>, colour_by<span class="op">=</span><span class="st">"sim_time"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/scater/man/plot_reddim.html" class="external-link">plotUMAP</a></span><span class="op">(</span><span class="va">bulk_sce</span>, colour_by<span class="op">=</span><span class="st">"slingPseudotime_1"</span><span class="op">)</span>,</span>
<span>  ncol<span class="op">=</span><span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="compare_simulated_data_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">bulk_sce</span> <span class="op">=</span> <span class="fu"><a href="../reference/assign_pseudotime_bins.html">assign_pseudotime_bins</a></span><span class="op">(</span><span class="va">bulk_sce</span>, split_by<span class="op">=</span><span class="st">'pseudotime_range'</span>, n_bins <span class="op">=</span> <span class="va">bins</span>, pseudotime_slot<span class="op">=</span><span class="st">"slingPseudotime_1"</span><span class="op">)</span></span>
<span><span class="va">bulk_sce</span><span class="op">$</span><span class="va">replicate</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>n<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">bulk_sce</span><span class="op">)</span>, min<span class="op">=</span><span class="fl">1</span>, max<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">bulkified_bins</span> <span class="op">=</span> <span class="fu">blase</span><span class="fu">::</span><span class="fu"><a href="../reference/get_bins_as_bulk.html">get_bins_as_bulk</a></span><span class="op">(</span><span class="va">bulk_sce</span>, min_cells_for_bulk <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="map-the-bulk-to-the-single-cell">Map the bulk to the single cell<a class="anchor" aria-label="anchor" href="#map-the-bulk-to-the-single-cell"></a>
</h2>
<p>Now we’ll map the bulk onto the single cell data with BLASE. We can
see the bins and mapping results below. Most are confidently mapped
correctly, and 4 are not confidently mapped, but still correctly.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mapping_results</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">bulkname</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">bulkified_bins</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">res</span> <span class="op">=</span> <span class="fu"><a href="../reference/map_best_bin.html">map_best_bin</a></span><span class="op">(</span><span class="va">blaseData</span>, <span class="va">bulkname</span>, <span class="va">bulkified_bins</span><span class="op">)</span></span>
<span>  <span class="va">mapping_results</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mapping_results</span>, <span class="va">res</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; MappingResult for 'bin_1_rep_1': best_bin=1 correlation=0.946888823830309 top_2_distance=0.2476</span></span>
<span><span class="co">#&gt;   Confident Result: TRUE (next max upper  0.769997447991129 )</span></span>
<span><span class="co">#&gt;   with history for scores against 5  bins</span></span>
<span><span class="co">#&gt;   Bootstrapped with 200 iterations</span></span>
<span><span class="co">#&gt; MappingResult for 'bin_1_rep_2': best_bin=1 correlation=0.950443436534111 top_2_distance=0.2694</span></span>
<span><span class="co">#&gt;   Confident Result: TRUE (next max upper  0.754488635370526 )</span></span>
<span><span class="co">#&gt;   with history for scores against 5  bins</span></span>
<span><span class="co">#&gt;   Bootstrapped with 200 iterations</span></span>
<span><span class="co">#&gt; MappingResult for 'bin_2_rep_1': best_bin=2 correlation=0.957806989320484 top_2_distance=0.0691</span></span>
<span><span class="co">#&gt;   Confident Result: TRUE (next max upper  0.906870888511905 )</span></span>
<span><span class="co">#&gt;   with history for scores against 5  bins</span></span>
<span><span class="co">#&gt;   Bootstrapped with 200 iterations</span></span>
<span><span class="co">#&gt; MappingResult for 'bin_2_rep_2': best_bin=2 correlation=0.975988675682019 top_2_distance=0.1295</span></span>
<span><span class="co">#&gt;   Confident Result: TRUE (next max upper  0.8652892971342 )</span></span>
<span><span class="co">#&gt;   with history for scores against 5  bins</span></span>
<span><span class="co">#&gt;   Bootstrapped with 200 iterations</span></span>
<span><span class="co">#&gt; MappingResult for 'bin_3_rep_1': best_bin=3 correlation=0.987316446339184 top_2_distance=0.0556</span></span>
<span><span class="co">#&gt;   Confident Result: TRUE (next max upper  0.951713419200516 )</span></span>
<span><span class="co">#&gt;   with history for scores against 5  bins</span></span>
<span><span class="co">#&gt;   Bootstrapped with 200 iterations</span></span>
<span><span class="co">#&gt; MappingResult for 'bin_3_rep_2': best_bin=3 correlation=0.985091257143017 top_2_distance=0.0554</span></span>
<span><span class="co">#&gt;   Confident Result: TRUE (next max upper  0.950155786763199 )</span></span>
<span><span class="co">#&gt;   with history for scores against 5  bins</span></span>
<span><span class="co">#&gt;   Bootstrapped with 200 iterations</span></span>
<span><span class="co">#&gt; MappingResult for 'bin_4_rep_1': best_bin=4 correlation=0.989654027705869 top_2_distance=0.0652</span></span>
<span><span class="co">#&gt;   Confident Result: TRUE (next max upper  0.938139741878059 )</span></span>
<span><span class="co">#&gt;   with history for scores against 5  bins</span></span>
<span><span class="co">#&gt;   Bootstrapped with 200 iterations</span></span>
<span><span class="co">#&gt; MappingResult for 'bin_4_rep_2': best_bin=4 correlation=0.98053176710876 top_2_distance=0.0685</span></span>
<span><span class="co">#&gt;   Confident Result: TRUE (next max upper  0.937145405732266 )</span></span>
<span><span class="co">#&gt;   with history for scores against 5  bins</span></span>
<span><span class="co">#&gt;   Bootstrapped with 200 iterations</span></span>
<span><span class="co">#&gt; MappingResult for 'bin_5_rep_1': best_bin=5 correlation=0.955157502867431 top_2_distance=0.1235</span></span>
<span><span class="co">#&gt;   Confident Result: TRUE (next max upper  0.851897232287168 )</span></span>
<span><span class="co">#&gt;   with history for scores against 5  bins</span></span>
<span><span class="co">#&gt;   Bootstrapped with 200 iterations</span></span>
<span><span class="co">#&gt; MappingResult for 'bin_5_rep_2': best_bin=5 correlation=0.945822678007565 top_2_distance=0.0772</span></span>
<span><span class="co">#&gt;   Confident Result: TRUE (next max upper  0.884636783758664 )</span></span>
<span><span class="co">#&gt;   with history for scores against 5  bins</span></span>
<span><span class="co">#&gt;   Bootstrapped with 200 iterations</span></span>
<span></span>
<span><span class="va">sc_sce</span> <span class="op">=</span> <span class="fu"><a href="../reference/assign_pseudotime_bins.html">assign_pseudotime_bins</a></span><span class="op">(</span><span class="va">sc_sce</span>, split_by <span class="op">=</span> <span class="st">'pseudotime_range'</span>, n_bins <span class="op">=</span> <span class="va">bins</span>, pseudotime_slot<span class="op">=</span><span class="st">'slingPseudotime_1'</span><span class="op">)</span></span>
<span><span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/scater/man/plot_reddim.html" class="external-link">plotUMAP</a></span><span class="op">(</span><span class="va">bulk_sce</span>, colour_by<span class="op">=</span><span class="st">"sim_time"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/scater/man/plot_reddim.html" class="external-link">plotUMAP</a></span><span class="op">(</span><span class="va">bulk_sce</span>, colour_by<span class="op">=</span><span class="st">"slingPseudotime_1"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/scater/man/plot_reddim.html" class="external-link">plotUMAP</a></span><span class="op">(</span><span class="va">sc_sce</span>, colour<span class="op">=</span><span class="st">"pseudotime_bin"</span><span class="op">)</span>,</span>
<span>  ncol<span class="op">=</span><span class="fl">3</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="compare_simulated_data_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">blase</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_mapping_result_heatmap.html">plot_mapping_result_heatmap</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">mapping_results</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="compare_simulated_data_files/figure-html/unnamed-chunk-9-2.png" width="700"></p>
<p>Now we can look at the population proportions of the bins.</p>
<p>Each row below shows the following four plots: 1. The
<strong>SC</strong> label proportions for a given bin 2. The
<strong>bulk</strong> label proportions for a given bin 3. Mapping
correlations for replicate 1 of a given bin 4. Mapping correlations for
replicate 2 of a given bin</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span></span>
<span>  <span class="fu">blase</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_bin_population.html">plot_bin_population</a></span><span class="op">(</span><span class="va">sc_sce</span>, <span class="fl">1</span>, group_by_slot<span class="op">=</span><span class="st">"label"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"SC Labels in Bin 1"</span><span class="op">)</span>,</span>
<span>  <span class="fu">blase</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_bin_population.html">plot_bin_population</a></span><span class="op">(</span><span class="va">bulk_sce</span>, <span class="fl">1</span>, group_by_slot<span class="op">=</span><span class="st">"label"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Bulk Labels in Bin 1"</span><span class="op">)</span>,</span>
<span>  <span class="fu">blase</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_mapping_result_corr.html">plot_mapping_result_corr</a></span><span class="op">(</span><span class="va">mapping_results</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Mapping correlations for bin 1 rep. 1"</span><span class="op">)</span>,</span>
<span>  <span class="fu">blase</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_mapping_result_corr.html">plot_mapping_result_corr</a></span><span class="op">(</span><span class="va">mapping_results</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Mapping correlations for bin 1 rep. 2"</span><span class="op">)</span>,</span>
<span>  ncol<span class="op">=</span><span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="compare_simulated_data_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span></span>
<span>  <span class="fu">blase</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_bin_population.html">plot_bin_population</a></span><span class="op">(</span><span class="va">sc_sce</span>, <span class="fl">2</span>, group_by_slot<span class="op">=</span><span class="st">"label"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"SC Labels in Bin 2"</span><span class="op">)</span>,</span>
<span>  <span class="fu">blase</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_bin_population.html">plot_bin_population</a></span><span class="op">(</span><span class="va">bulk_sce</span>, <span class="fl">2</span>, group_by_slot<span class="op">=</span><span class="st">"label"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Bulk Labels in Bin 2"</span><span class="op">)</span>,</span>
<span>  <span class="fu">blase</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_mapping_result_corr.html">plot_mapping_result_corr</a></span><span class="op">(</span><span class="va">mapping_results</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Mapping correlations for bin 2 rep. 1"</span><span class="op">)</span>,</span>
<span>  <span class="fu">blase</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_mapping_result_corr.html">plot_mapping_result_corr</a></span><span class="op">(</span><span class="va">mapping_results</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Mapping correlations for bin 2 rep. 2"</span><span class="op">)</span>,</span>
<span>  ncol<span class="op">=</span><span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="compare_simulated_data_files/figure-html/unnamed-chunk-10-2.png" width="700"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span></span>
<span>  <span class="fu">blase</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_bin_population.html">plot_bin_population</a></span><span class="op">(</span><span class="va">sc_sce</span>, <span class="fl">3</span>, group_by_slot<span class="op">=</span><span class="st">"label"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"SC Labels in Bin 3"</span><span class="op">)</span>,</span>
<span>  <span class="fu">blase</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_bin_population.html">plot_bin_population</a></span><span class="op">(</span><span class="va">bulk_sce</span>, <span class="fl">3</span>, group_by_slot<span class="op">=</span><span class="st">"label"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Bulk Labels in Bin 3"</span><span class="op">)</span>,</span>
<span>  <span class="fu">blase</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_mapping_result_corr.html">plot_mapping_result_corr</a></span><span class="op">(</span><span class="va">mapping_results</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Mapping correlations for bin 3 rep. 1"</span><span class="op">)</span>,</span>
<span>  <span class="fu">blase</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_mapping_result_corr.html">plot_mapping_result_corr</a></span><span class="op">(</span><span class="va">mapping_results</span><span class="op">[[</span><span class="fl">6</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Mapping correlations for bin 3 rep. 2"</span><span class="op">)</span>,</span>
<span>  ncol<span class="op">=</span><span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="compare_simulated_data_files/figure-html/unnamed-chunk-10-3.png" width="700"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span></span>
<span>  <span class="fu">blase</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_bin_population.html">plot_bin_population</a></span><span class="op">(</span><span class="va">sc_sce</span>, <span class="fl">4</span>, group_by_slot<span class="op">=</span><span class="st">"label"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"SC Labels in Bin 4"</span><span class="op">)</span>,</span>
<span>  <span class="fu">blase</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_bin_population.html">plot_bin_population</a></span><span class="op">(</span><span class="va">bulk_sce</span>, <span class="fl">4</span>, group_by_slot<span class="op">=</span><span class="st">"label"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Bulk Labels in Bin 4"</span><span class="op">)</span>,</span>
<span>  <span class="fu">blase</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_mapping_result_corr.html">plot_mapping_result_corr</a></span><span class="op">(</span><span class="va">mapping_results</span><span class="op">[[</span><span class="fl">7</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Mapping correlations for bin 4 rep. 1"</span><span class="op">)</span>,</span>
<span>  <span class="fu">blase</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_mapping_result_corr.html">plot_mapping_result_corr</a></span><span class="op">(</span><span class="va">mapping_results</span><span class="op">[[</span><span class="fl">8</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Mapping correlations for bin 4 rep. 2"</span><span class="op">)</span>,</span>
<span>  ncol<span class="op">=</span><span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="compare_simulated_data_files/figure-html/unnamed-chunk-10-4.png" width="700"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span></span>
<span>  <span class="fu">blase</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_bin_population.html">plot_bin_population</a></span><span class="op">(</span><span class="va">sc_sce</span>, <span class="fl">5</span>, group_by_slot<span class="op">=</span><span class="st">"label"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"SC Labels in Bin 5"</span><span class="op">)</span>,</span>
<span>  <span class="fu">blase</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_bin_population.html">plot_bin_population</a></span><span class="op">(</span><span class="va">bulk_sce</span>, <span class="fl">5</span>, group_by_slot<span class="op">=</span><span class="st">"label"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Bulk Labels in Bin 5"</span><span class="op">)</span>,</span>
<span>  <span class="fu">blase</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_mapping_result_corr.html">plot_mapping_result_corr</a></span><span class="op">(</span><span class="va">mapping_results</span><span class="op">[[</span><span class="fl">9</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Mapping correlations for bin 5 rep. 1"</span><span class="op">)</span>,</span>
<span>  <span class="fu">blase</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_mapping_result_corr.html">plot_mapping_result_corr</a></span><span class="op">(</span><span class="va">mapping_results</span><span class="op">[[</span><span class="fl">10</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Mapping correlations for bin 5 rep. 2"</span><span class="op">)</span>,</span>
<span>  ncol<span class="op">=</span><span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="compare_simulated_data_files/figure-html/unnamed-chunk-10-5.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.4.0 (2024-04-24)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 22.04.4 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Random number generation:</span></span>
<span><span class="co">#&gt;  RNG:     Mersenne-Twister </span></span>
<span><span class="co">#&gt;  Normal:  Inversion </span></span>
<span><span class="co">#&gt;  Sample:  Rounding </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats4    stats     graphics  grDevices utils     datasets  methods  </span></span>
<span><span class="co">#&gt; [8] base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt;  [1] fs_1.6.4                    bluster_1.14.0             </span></span>
<span><span class="co">#&gt;  [3] dyngen_1.0.5                BiocParallel_1.38.0        </span></span>
<span><span class="co">#&gt;  [5] scater_1.32.0               ggplot2_3.5.1              </span></span>
<span><span class="co">#&gt;  [7] scran_1.32.0                scuttle_1.14.0             </span></span>
<span><span class="co">#&gt;  [9] slingshot_2.12.0            TrajectoryUtils_1.12.0     </span></span>
<span><span class="co">#&gt; [11] princurve_2.1.6             tradeSeq_1.18.0            </span></span>
<span><span class="co">#&gt; [13] SingleCellExperiment_1.26.0 SummarizedExperiment_1.34.0</span></span>
<span><span class="co">#&gt; [15] Biobase_2.64.0              GenomicRanges_1.56.0       </span></span>
<span><span class="co">#&gt; [17] GenomeInfoDb_1.40.0         IRanges_2.38.0             </span></span>
<span><span class="co">#&gt; [19] S4Vectors_0.42.0            BiocGenerics_0.50.0        </span></span>
<span><span class="co">#&gt; [21] MatrixGenerics_1.16.0       matrixStats_1.3.0          </span></span>
<span><span class="co">#&gt; [23] blase_0.0.0.9000           </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;   [1] RColorBrewer_1.1-3        jsonlite_1.8.8           </span></span>
<span><span class="co">#&gt;   [3] magrittr_2.0.3            ggbeeswarm_0.7.2         </span></span>
<span><span class="co">#&gt;   [5] farver_2.1.1              rmarkdown_2.26           </span></span>
<span><span class="co">#&gt;   [7] RcppXPtrUtils_0.1.2       zlibbioc_1.50.0          </span></span>
<span><span class="co">#&gt;   [9] ragg_1.3.1                vctrs_0.6.5              </span></span>
<span><span class="co">#&gt;  [11] memoise_2.0.1             DelayedMatrixStats_1.26.0</span></span>
<span><span class="co">#&gt;  [13] htmltools_0.5.8.1         S4Arrays_1.4.0           </span></span>
<span><span class="co">#&gt;  [15] BiocNeighbors_1.22.0      ami_0.1.0                </span></span>
<span><span class="co">#&gt;  [17] SparseArray_1.4.3         sass_0.4.9               </span></span>
<span><span class="co">#&gt;  [19] bslib_0.7.0               htmlwidgets_1.6.4        </span></span>
<span><span class="co">#&gt;  [21] desc_1.4.3                cachem_1.0.8             </span></span>
<span><span class="co">#&gt;  [23] igraph_2.0.3              lifecycle_1.0.4          </span></span>
<span><span class="co">#&gt;  [25] pkgconfig_2.0.3           rsvd_1.0.5               </span></span>
<span><span class="co">#&gt;  [27] Matrix_1.7-0              R6_2.5.1                 </span></span>
<span><span class="co">#&gt;  [29] fastmap_1.1.1             GenomeInfoDbData_1.2.12  </span></span>
<span><span class="co">#&gt;  [31] digest_0.6.35             colorspace_2.1-0         </span></span>
<span><span class="co">#&gt;  [33] patchwork_1.2.0           metR_0.15.0              </span></span>
<span><span class="co">#&gt;  [35] dqrng_0.3.2               irlba_2.3.5.1            </span></span>
<span><span class="co">#&gt;  [37] textshaping_0.3.7         beachmat_2.20.0          </span></span>
<span><span class="co">#&gt;  [39] labeling_0.4.3            lmds_0.1.0               </span></span>
<span><span class="co">#&gt;  [41] fansi_1.0.6               polyclip_1.10-6          </span></span>
<span><span class="co">#&gt;  [43] httr_1.4.7                abind_1.4-5              </span></span>
<span><span class="co">#&gt;  [45] mgcv_1.9-1                compiler_4.4.0           </span></span>
<span><span class="co">#&gt;  [47] remotes_2.5.0             GillespieSSA2_0.3.0      </span></span>
<span><span class="co">#&gt;  [49] withr_3.0.0               backports_1.4.1          </span></span>
<span><span class="co">#&gt;  [51] viridis_0.6.5             highr_0.10               </span></span>
<span><span class="co">#&gt;  [53] ggforce_0.4.2             MASS_7.3-60.2            </span></span>
<span><span class="co">#&gt;  [55] proxyC_0.4.1              DelayedArray_0.30.1      </span></span>
<span><span class="co">#&gt;  [57] tools_4.4.0               vipor_0.4.7              </span></span>
<span><span class="co">#&gt;  [59] beeswarm_0.4.0            dynutils_1.0.11          </span></span>
<span><span class="co">#&gt;  [61] glue_1.7.0                nlme_3.1-164             </span></span>
<span><span class="co">#&gt;  [63] grid_4.4.0                checkmate_2.3.1          </span></span>
<span><span class="co">#&gt;  [65] cluster_2.1.6             generics_0.1.3           </span></span>
<span><span class="co">#&gt;  [67] gtable_0.3.5              tzdb_0.4.0               </span></span>
<span><span class="co">#&gt;  [69] tidyr_1.3.1               data.table_1.15.4        </span></span>
<span><span class="co">#&gt;  [71] hms_1.1.3                 BiocSingular_1.20.0      </span></span>
<span><span class="co">#&gt;  [73] tidygraph_1.3.1           ScaledMatrix_1.12.0      </span></span>
<span><span class="co">#&gt;  [75] metapod_1.12.0            utf8_1.2.4               </span></span>
<span><span class="co">#&gt;  [77] XVector_0.44.0            ggrepel_0.9.5            </span></span>
<span><span class="co">#&gt;  [79] pillar_1.9.0              stringr_1.5.1            </span></span>
<span><span class="co">#&gt;  [81] limma_3.60.0              splines_4.4.0            </span></span>
<span><span class="co">#&gt;  [83] tweenr_2.0.3              dplyr_1.1.4              </span></span>
<span><span class="co">#&gt;  [85] lattice_0.22-6            tidyselect_1.2.1         </span></span>
<span><span class="co">#&gt;  [87] locfit_1.5-9.9            pbapply_1.7-2            </span></span>
<span><span class="co">#&gt;  [89] knitr_1.46                gridExtra_2.3            </span></span>
<span><span class="co">#&gt;  [91] edgeR_4.2.0               xfun_0.43                </span></span>
<span><span class="co">#&gt;  [93] graphlayouts_1.1.1        statmod_1.5.0            </span></span>
<span><span class="co">#&gt;  [95] stringi_1.8.4             UCSC.utils_1.0.0         </span></span>
<span><span class="co">#&gt;  [97] yaml_2.3.8                evaluate_0.23            </span></span>
<span><span class="co">#&gt;  [99] codetools_0.2-20          ggraph_2.2.1             </span></span>
<span><span class="co">#&gt; [101] tibble_3.2.1              cli_3.6.2                </span></span>
<span><span class="co">#&gt; [103] systemfonts_1.0.6         munsell_0.5.1            </span></span>
<span><span class="co">#&gt; [105] jquerylib_0.1.4           Rcpp_1.0.12              </span></span>
<span><span class="co">#&gt; [107] parallel_4.4.0            pkgdown_2.0.9            </span></span>
<span><span class="co">#&gt; [109] readr_2.1.5               assertthat_0.2.1         </span></span>
<span><span class="co">#&gt; [111] sparseMatrixStats_1.16.0  viridisLite_0.4.2        </span></span>
<span><span class="co">#&gt; [113] scales_1.3.0              purrr_1.0.2              </span></span>
<span><span class="co">#&gt; [115] crayon_1.5.2              rlang_1.1.3              </span></span>
<span><span class="co">#&gt; [117] cowplot_1.1.3</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Andrew McCluskey, Toby Kettlewell, Thomas Otto.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
