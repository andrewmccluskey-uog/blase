<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="blase">
<title>DE With BLASE • blase</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="DE With BLASE">
<meta property="og:description" content="blase">
<meta property="og:image" content="https://andrewmccluskey-uog.github.io/BLASE/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">blase</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Vignettes</h6>
    <a class="dropdown-item" href="../articles/how-blase-works.html">How BLASE Works</a>
    <a class="dropdown-item" href="../articles/assign-bulk-to-pseudotime.html">Assign Bulk To SC Pseudotime</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Further Analysis with BLASE</h6>
    <a class="dropdown-item" href="../articles/compare_simulated_data.html">Simulated Data Workthrough</a>
    <a class="dropdown-item" href="../articles/DE_with_blase.html">DE with Blase</a>
    <a class="dropdown-item" href="../articles/falciparum_lifecycle.html">P. Falciparum Lifecycle - Comparing Bozdech and TradeSeq</a>
    <a class="dropdown-item" href="../articles/gene_selection_comparison.html">Comparing Gene Selection Methods In Depth</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Data Generation</h6>
    <a class="dropdown-item" href="../articles/generate-MCA-pb-object.html">Malaria Cell Atlas PB</a>
    <a class="dropdown-item" href="../articles/generate-MCA-pf-object.html">Malaria Cell Atlas PF</a>
    <a class="dropdown-item" href="../articles/generate-simulated-data-object.html">Simulation Data</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>DE With BLASE</h1>
            
      
      
      <div class="d-none name"><code>DE_with_blase.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org" class="external-link">readxl</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">scran</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">slingshot</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://statomics.github.io/tradeSeq/index.html" class="external-link">tradeSeq</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Bioconductor/BiocParallel" class="external-link">BiocParallel</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://fs.r-lib.org" class="external-link">fs</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://bioconductor.org/packages/scater/" class="external-link">scater</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">utils</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://andrewmccluskey-uog.github.io/BLASE/">blase</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/briandconnelly/ami" class="external-link">ami</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://had.co.nz/plyr" class="external-link">plyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://scales.r-lib.org" class="external-link">scales</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/reshape" class="external-link">reshape2</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">RNGversion</a></span><span class="op">(</span><span class="st">"3.5.0"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in RNGkind("Mersenne-Twister", "Inversion", "Rounding"): non-uniform</span></span>
<span><span class="co">#&gt; 'Rounding' sampler used</span></span>
<span><span class="va">SEED</span> <span class="op">=</span> <span class="fl">7</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">SEED</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">N_CORES</span> <span class="op">=</span> <span class="fl">4</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu">ami</span><span class="fu">::</span><span class="fu"><a href="https://briandconnelly.github.io/ami/reference/ci.html" class="external-link">using_ci</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">N_CORES</span> <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>In this vignette we will use BLASE to map bulk Plasmodium Falciparum
data from an experiment (<a href="https://doi.org/10.1038/s41467-021-24814-1" class="external-link">Zhang et al. 2021</a>)
on heat shock response in P. Falciparum, onto the Malaria Cell Atlas (<a href="https://doi.org/10.1126/science.aaw2619" class="external-link">Howick et al. 2019</a>,
7G8 &amp; NF54 strains). We look at Zhang et al’s wild type control data
(from the NF54 strain) as well as the knockouts (pb4 and pb31) in this
article. The paper reported that the knockouts both handled the heat
shock less well than the wild type strain, and that pb31 was most
susceptible to heat shock, which we will see in our analysis below.</p>
<p>The controls kept all strains at 37 degrees, whereas the heat shock
was applied to each strain as 3 8-hour increases to 41 degrees,
simulating malarial fever.</p>
<div class="section level2">
<h2 id="fetch-the-data">Fetch the data<a class="anchor" aria-label="anchor" href="#fetch-the-data"></a>
</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ext_data_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"blase"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">root_dir</span> <span class="op">=</span> <span class="fu">tools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/tools/userdir.html" class="external-link">R_user_dir</a></span><span class="op">(</span><span class="st">"BLASE"</span>, <span class="st">"data"</span><span class="op">)</span></span>
<span><span class="va">article_dir</span> <span class="op">=</span> <span class="fu"><a href="https://fs.r-lib.org/reference/path.html" class="external-link">path</a></span><span class="op">(</span><span class="va">root_dir</span>, <span class="st">"DE_with_blase"</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.exists</a></span><span class="op">(</span><span class="va">article_dir</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">article_dir</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">bulk_path</span> <span class="op">=</span> <span class="fu"><a href="https://fs.r-lib.org/reference/path.html" class="external-link">path</a></span><span class="op">(</span><span class="va">article_dir</span>, <span class="st">"heat_shock_bulks"</span>, ext<span class="op">=</span><span class="st">"xlsx"</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="va">bulk_path</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file</a></span><span class="op">(</span><span class="st">'https://static-content.springer.com/esm/art%3A10.1038%2Fs41467-021-24814-1/MediaObjects/41467_2021_24814_MOESM5_ESM.xlsx'</span>, <span class="va">bulk_path</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Using cached"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># FPKM normalised</span></span>
<span><span class="va">bulk</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html" class="external-link">read_excel</a></span><span class="op">(</span><span class="va">bulk_path</span>, range <span class="op">=</span> <span class="st">'S3A_RNAseq!A4:P2571'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">bulk</span><span class="op">)</span> <span class="op">=</span> <span class="va">bulk</span><span class="op">$</span><span class="va">`Transcript_ID`</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">bulk</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">bulk</span><span class="op">)</span>, pattern<span class="op">=</span><span class="st">"_"</span>, replacement<span class="op">=</span><span class="st">"-"</span>, fixed<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bulk</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">bulk</span>, , <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">`GeneID`</span>, <span class="va">`Transcript_ID`</span>, <span class="va">`Gene.NameSymbol`</span>, <span class="va">`TranscriptProductDescription`</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">genes_to_fix_bulk</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">bulk</span><span class="op">)</span><span class="op">[</span><span class="op">!</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">bulk</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">bulk</span><span class="op">)</span>, pattern<span class="op">=</span><span class="st">"\\.[0-9]"</span>, replacement<span class="op">=</span><span class="st">""</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">genes_to_fix_bulk</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">genes_to_fix_bulk</span>, pattern<span class="op">=</span><span class="st">"\\.[0-9]"</span>, replacement<span class="op">=</span><span class="st">""</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new_rows</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">rownames_to_remove</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Do some pre-work to get colSums quickly</span></span>
<span><span class="va">bulk_matrix</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html" class="external-link">data.matrix</a></span><span class="op">(</span><span class="va">bulk</span><span class="op">)</span></span>
<span><span class="va">bulk_n</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">bulk_matrix</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">gene</span> <span class="kw">in</span> <span class="va">genes_to_fix_bulk</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">targetRowNames</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">bulk</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">bulk</span><span class="op">)</span>, pattern<span class="op">=</span><span class="va">gene</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">rownames_to_remove</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">rownames_to_remove</span>, <span class="va">targetRowNames</span><span class="op">)</span></span>
<span>  <span class="co"># N = col index, M = row index</span></span>
<span>  <span class="va">counts</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">.colSums</a></span><span class="op">(</span><span class="va">bulk_matrix</span><span class="op">[</span><span class="va">targetRowNames</span>,<span class="op">]</span>, m<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">targetRowNames</span><span class="op">)</span>, n<span class="op">=</span><span class="va">bulk_n</span><span class="op">)</span></span>
<span>  <span class="va">counts</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>counts<span class="op">=</span><span class="va">counts</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">counts</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">gene</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">counts</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">bulk</span><span class="op">)</span></span>
<span>  <span class="va">new_rows</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">new_rows</span>, <span class="va">counts</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">bulk</span> <span class="op">=</span> <span class="va">bulk</span><span class="op">[</span> <span class="op">!</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">bulk</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">rownames_to_remove</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">bulk</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">bulk</span>, <span class="va">new_rows</span><span class="op">)</span></span>
<span></span>
<span><span class="va">genes_to_fix_bulk</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">bulk</span><span class="op">)</span><span class="op">[</span><span class="op">!</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">bulk</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">bulk</span><span class="op">)</span>, pattern<span class="op">=</span><span class="st">"\\.[0-9]"</span>, replacement<span class="op">=</span><span class="st">""</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">genes_to_fix_bulk</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">genes_to_fix_bulk</span>, pattern<span class="op">=</span><span class="st">"\\.[0-9]"</span>, replacement<span class="op">=</span><span class="st">""</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Remaining genes with dups:"</span>, <span class="va">genes_to_fix_bulk</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Remaining genes with dups: "</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span> <span class="op">(</span><span class="va">new_rows</span>, <span class="va">rownames_to_remove</span>, <span class="va">bulk_matrix</span>, <span class="va">bulk_n</span>, <span class="va">genes_to_fix_bulk</span>, <span class="va">counts</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/gc.html" class="external-link">gc</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;            used  (Mb) gc trigger  (Mb) max used  (Mb)</span></span>
<span><span class="co">#&gt; Ncells  7916020 422.8   11593821 619.2 10952588 585.0</span></span>
<span><span class="co">#&gt; Vcells 13912033 106.2   21681406 165.5 18001140 137.4</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="prepare-sc">Prepare SC<a class="anchor" aria-label="anchor" href="#prepare-sc"></a>
</h2>
<p>We are using the Malaria Cell Atlas data which we have pre-processed
(here)[articles/generate-MCA-pf-object.html]. This data is available for
your to experiment with as part of the package.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">processed_MCA_PF_SCE</span>, package<span class="op">=</span><span class="st">"blase"</span><span class="op">)</span></span>
<span><span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/plotPCA.html" class="external-link">plotPCA</a></span><span class="op">(</span><span class="va">processed_MCA_PF_SCE</span>, colour_by<span class="op">=</span><span class="st">"STAGE_LR"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/scater/man/plot_reddim.html" class="external-link">plotUMAP</a></span><span class="op">(</span><span class="va">processed_MCA_PF_SCE</span>, colour_by<span class="op">=</span><span class="st">"STAGE_LR"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/plotPCA.html" class="external-link">plotPCA</a></span><span class="op">(</span><span class="va">processed_MCA_PF_SCE</span>, colour_by<span class="op">=</span><span class="st">"DAY"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/scater/man/plot_reddim.html" class="external-link">plotUMAP</a></span><span class="op">(</span><span class="va">processed_MCA_PF_SCE</span>, colour_by<span class="op">=</span><span class="st">"DAY"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/plotPCA.html" class="external-link">plotPCA</a></span><span class="op">(</span><span class="va">processed_MCA_PF_SCE</span>, colour_by<span class="op">=</span><span class="st">"STRAIN"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/scater/man/plot_reddim.html" class="external-link">plotUMAP</a></span><span class="op">(</span><span class="va">processed_MCA_PF_SCE</span>, colour_by<span class="op">=</span><span class="st">"STRAIN"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/plotPCA.html" class="external-link">plotPCA</a></span><span class="op">(</span><span class="va">processed_MCA_PF_SCE</span>, colour_by<span class="op">=</span><span class="st">"slingPseudotime_1"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/scater/man/plot_reddim.html" class="external-link">plotUMAP</a></span><span class="op">(</span><span class="va">processed_MCA_PF_SCE</span>, colour_by<span class="op">=</span><span class="st">"slingPseudotime_1"</span><span class="op">)</span>,</span>
<span>  ncol<span class="op">=</span><span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="DE_with_blase_files/figure-html/loadSC-1.png" width="700"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">associationTestResult</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/tradeSeq/man/associationTest.html" class="external-link">associationTest</a></span><span class="op">(</span><span class="va">processed_MCA_PF_SCE</span>, lineages<span class="op">=</span><span class="cn">T</span>, global<span class="op">=</span><span class="cn">F</span>, contrastType<span class="op">=</span><span class="st">"consecutive"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="prepare-blase">Prepare BLASE<a class="anchor" aria-label="anchor" href="#prepare-blase"></a>
</h2>
<p>We prepare BLASE by checking for a good number of genes and bins.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">genelist</span> <span class="op">=</span> <span class="fu">blase</span><span class="fu">::</span><span class="fu"><a href="../reference/get_top_n_genes.html">get_top_n_genes</a></span><span class="op">(</span><span class="va">associationTestResult</span>, n_genes <span class="op">=</span> <span class="fl">500</span>, lineage <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res</span> <span class="op">=</span> <span class="fu"><a href="../reference/find_best_params.html">find_best_params</a></span><span class="op">(</span><span class="va">processed_MCA_PF_SCE</span>,</span>
<span>                       <span class="va">genelist</span>,</span>
<span>                       split_by<span class="op">=</span><span class="st">"pseudotime_range"</span>,</span>
<span>                       pseudotime_slot<span class="op">=</span><span class="st">"slingPseudotime_1"</span>,</span>
<span>                       bins_count_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">8</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>                       gene_count_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq.int</a></span><span class="op">(</span><span class="fl">250</span>, <span class="fl">340</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_find_best_params_results.html">plot_find_best_params_results</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code></pre></div>
<p><img src="DE_with_blase_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#cat(gsub(x=paste0("", genelist), pattern="-", replacement = "_"), sep = "\n")</span></span>
<span></span>
<span><span class="co">#waves = blase::get_waves(processed_MCA_PF_SCE)</span></span>
<span></span>
<span><span class="co">#waves[c("PF3D7-0831700","PF3D7-1116800"),]</span></span>
<span></span>
<span><span class="co">#blase::gene_selection_matrix(processed_MCA_PF_SCE, genes=c(</span></span>
<span><span class="co">#  "PF3D7-0831700", </span></span>
<span><span class="co">#  "PF3D7-1116800",</span></span>
<span><span class="co">#  "PF3D7-1014100",</span></span>
<span><span class="co">#  "PF3D7-0303200",</span></span>
<span><span class="co">#  "PF3D7-0701900"</span></span>
<span><span class="co">#  ), waves=waves, target_matrix_size=5)</span></span>
<span></span>
<span><span class="co">#length(genelist)</span></span>
<span><span class="co">#genelist = genelist[!(genelist %in% c("PF3D7-0831700","PF3D7-1116800"))]</span></span>
<span><span class="co">#length(genelist)</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">genes</span> <span class="op">=</span> <span class="fl">300</span></span>
<span><span class="va">bins</span> <span class="op">=</span> <span class="fl">8</span></span>
<span><span class="va">blaseData</span> <span class="op">=</span> <span class="fu"><a href="../reference/as.BlaseData.html">as.BlaseData</a></span><span class="op">(</span><span class="va">processed_MCA_PF_SCE</span>, pseudotime_slot<span class="op">=</span><span class="st">"slingPseudotime_1"</span>, n_bins<span class="op">=</span><span class="va">bins</span>, split_by<span class="op">=</span><span class="st">"pseudotime_range"</span><span class="op">)</span></span>
<span><span class="va">blaseData</span><span class="op">@</span><span class="va">genes</span> <span class="op">=</span> <span class="va">genelist</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">genes</span><span class="op">]</span></span>
<span><span class="fu"><a href="../reference/evaluate_parameters.html">evaluate_parameters</a></span><span class="op">(</span><span class="va">blaseData</span>, make_plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="DE_with_blase_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; [1] 0.219500 0.274575</span></span>
<span><span class="va">processed_MCA_PF_SCE</span> <span class="op">=</span> <span class="fu"><a href="../reference/assign_pseudotime_bins.html">assign_pseudotime_bins</a></span><span class="op">(</span><span class="va">processed_MCA_PF_SCE</span>, pseudotime_slot<span class="op">=</span><span class="st">"slingPseudotime_1"</span>, n_bins<span class="op">=</span><span class="va">bins</span>, split_by<span class="op">=</span><span class="st">"pseudotime_range"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/scater/man/plot_reddim.html" class="external-link">plotUMAP</a></span><span class="op">(</span><span class="va">processed_MCA_PF_SCE</span>, color<span class="op">=</span><span class="st">"pseudotime_bin"</span><span class="op">)</span></span></code></pre>
<p><img src="DE_with_blase_files/figure-html/unnamed-chunk-4-2.png" width="700"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/scater/man/plot_reddim.html" class="external-link">plotUMAP</a></span><span class="op">(</span><span class="va">processed_MCA_PF_SCE</span>, color<span class="op">=</span><span class="st">"STAGE_LR"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/scater/man/plot_reddim.html" class="external-link">plotUMAP</a></span><span class="op">(</span><span class="va">processed_MCA_PF_SCE</span>, color<span class="op">=</span><span class="st">"pseudotime_bin"</span><span class="op">)</span>,</span>
<span>  ncol<span class="op">=</span><span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="DE_with_blase_files/figure-html/unnamed-chunk-4-3.png" width="700"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#waves = get_waves(processed_MCA_PF_SCE, n_cores = N_CORES)</span></span>
<span><span class="co">#fourier_genes = blase::select_genes_by_fourier_method(processed_MCA_PF_SCE, waves, n_groups=100, top_n_per_group=5)</span></span>
<span><span class="co">#fourier_genes</span></span>
<span><span class="co">#gene_selection_matrix(processed_MCA_PF_SCE, waves, genes=rownames(fourier_genes), target_matrix_size=90)</span></span>
<span></span>
<span><span class="co">#dim(fourier_genes)</span></span>
<span><span class="co">#fourier_genes = fourier_genes[ !(rownames(fourier_genes) %in%  c("PF3D7-0831700","PF3D7-1116800", "PF3D7_0201800")), ]</span></span>
<span><span class="co">#dim(fourier_genes)</span></span>
<span></span>
<span><span class="co">#blaseData@genes = rownames(fourier_genes)</span></span>
<span><span class="co">#cat(gsub(x=paste0("", rownames(fourier_genes)), pattern="-", replacement = "_"), sep = "\n")</span></span></code></pre></div>
<p>And we can see these genes arranged over pseudotime:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">waves</span> <span class="op">=</span> <span class="fu"><a href="../reference/get_waves.html">get_waves</a></span><span class="op">(</span><span class="va">processed_MCA_PF_SCE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/gene_selection_matrix.html">gene_selection_matrix</a></span><span class="op">(</span><span class="va">processed_MCA_PF_SCE</span>, <span class="va">waves</span>, genes<span class="op">=</span><span class="va">blaseData</span><span class="op">@</span><span class="va">genes</span>, target_matrix_size<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">blaseData</span><span class="op">@</span><span class="va">genes</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="DE_with_blase_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="map-bulk-data-onto-single-cell">Map Bulk data onto Single Cell<a class="anchor" aria-label="anchor" href="#map-bulk-data-onto-single-cell"></a>
</h2>
<p>Now we can map the bulk data onto the single cell.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mapping_results</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">bulkname</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">bulk</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">res</span> <span class="op">=</span> <span class="fu"><a href="../reference/map_best_bin.html">map_best_bin</a></span><span class="op">(</span><span class="va">blaseData</span>, <span class="va">bulkname</span>, <span class="va">bulk</span><span class="op">)</span></span>
<span>  <span class="va">mapping_results</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mapping_results</span>, <span class="va">res</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">blase</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_mapping_result_heatmap.html">plot_mapping_result_heatmap</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">mapping_results</span><span class="op">)</span>, annotate <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="DE_with_blase_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>We can see the wild type develops more normally than the 2 knockouts,
who show delayed growth generally, and less of a response to the heat
shock (41 degrees).</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Wildtype</span></span>
<span><span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span></span>
<span>  <span class="fu">blase</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_mapping_result_heatmap.html">plot_mapping_result_heatmap</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">mapping_results</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, annotate <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="co"># 1</span></span>
<span>  <span class="fu">blase</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_mapping_result_heatmap.html">plot_mapping_result_heatmap</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">mapping_results</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>, annotate <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="co"># 2</span></span>
<span>  <span class="fu">blase</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_bin_population.html">plot_bin_population</a></span><span class="op">(</span><span class="va">processed_MCA_PF_SCE</span>, <span class="fl">2</span>, group_by_slot<span class="op">=</span><span class="st">"STAGE_LR"</span><span class="op">)</span>, <span class="co"># 1</span></span>
<span>  <span class="fu">blase</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_bin_population.html">plot_bin_population</a></span><span class="op">(</span><span class="va">processed_MCA_PF_SCE</span>, <span class="fl">4</span>, group_by_slot<span class="op">=</span><span class="st">"STAGE_LR"</span><span class="op">)</span>, <span class="co"># 2</span></span>
<span>  <span class="fu">blase</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_bin_population.html">plot_bin_population</a></span><span class="op">(</span><span class="va">processed_MCA_PF_SCE</span>, <span class="fl">3</span>, group_by_slot<span class="op">=</span><span class="st">"STAGE_LR"</span><span class="op">)</span>, <span class="co"># 1</span></span>
<span>  <span class="fu">blase</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_bin_population.html">plot_bin_population</a></span><span class="op">(</span><span class="va">processed_MCA_PF_SCE</span>, <span class="fl">4</span>, group_by_slot<span class="op">=</span><span class="st">"STAGE_LR"</span><span class="op">)</span>, <span class="co"># 2</span></span>
<span>  ncol<span class="op">=</span><span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="DE_with_blase_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># pb4 knockout</span></span>
<span><span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span></span>
<span>  <span class="fu">blase</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_mapping_result_heatmap.html">plot_mapping_result_heatmap</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">mapping_results</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span>, annotate <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="co"># 1</span></span>
<span>  <span class="fu">blase</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_mapping_result_heatmap.html">plot_mapping_result_heatmap</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">mapping_results</span><span class="op">[</span><span class="fl">7</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span><span class="op">)</span>, annotate <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="co"># 2</span></span>
<span>  <span class="fu">blase</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_bin_population.html">plot_bin_population</a></span><span class="op">(</span><span class="va">processed_MCA_PF_SCE</span>, <span class="fl">2</span>, group_by_slot<span class="op">=</span><span class="st">"STAGE_LR"</span><span class="op">)</span>, <span class="co"># 1</span></span>
<span>  <span class="fu">blase</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_bin_population.html">plot_bin_population</a></span><span class="op">(</span><span class="va">processed_MCA_PF_SCE</span>, <span class="fl">3</span>, group_by_slot<span class="op">=</span><span class="st">"STAGE_LR"</span><span class="op">)</span>, <span class="co"># 2</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span>, <span class="co"># 1</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span>, <span class="co"># 2</span></span>
<span>  ncol<span class="op">=</span><span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="DE_with_blase_files/figure-html/unnamed-chunk-8-2.png" width="700"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># pb31 knockout</span></span>
<span><span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span></span>
<span>  <span class="fu">blase</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_mapping_result_heatmap.html">plot_mapping_result_heatmap</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">mapping_results</span><span class="op">[</span><span class="fl">9</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span>, annotate <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="co"># 1</span></span>
<span>  <span class="fu">blase</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_mapping_result_heatmap.html">plot_mapping_result_heatmap</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">mapping_results</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">12</span><span class="op">]</span><span class="op">)</span>, annotate <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="co"># 2</span></span>
<span>  <span class="fu">blase</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_bin_population.html">plot_bin_population</a></span><span class="op">(</span><span class="va">processed_MCA_PF_SCE</span>, <span class="fl">1</span>, group_by_slot<span class="op">=</span><span class="st">"STAGE_LR"</span><span class="op">)</span>, <span class="co"># 1</span></span>
<span>  <span class="fu">blase</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_bin_population.html">plot_bin_population</a></span><span class="op">(</span><span class="va">processed_MCA_PF_SCE</span>, <span class="fl">3</span>, group_by_slot<span class="op">=</span><span class="st">"STAGE_LR"</span><span class="op">)</span>, <span class="co"># 2</span></span>
<span>  <span class="fu">blase</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_bin_population.html">plot_bin_population</a></span><span class="op">(</span><span class="va">processed_MCA_PF_SCE</span>, <span class="fl">2</span>, group_by_slot<span class="op">=</span><span class="st">"STAGE_LR"</span><span class="op">)</span>, <span class="co"># 1</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span>, <span class="co">#2</span></span>
<span>  ncol<span class="op">=</span><span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="DE_with_blase_files/figure-html/unnamed-chunk-8-3.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="cibersort-analysis-for-comparison">Cibersort Analysis for comparison<a class="anchor" aria-label="anchor" href="#cibersort-analysis-for-comparison"></a>
</h2>
<p>Cibersortx is another tool which could be used for this kind of
analysis. Let’s see how it performs compared to BLASE. Below is code for
producing the files we used to analyse with cibersortx.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cibersort_bulk</span> <span class="op">=</span> <span class="va">bulk</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">cibersort_bulk</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">cibersort_bulk</span><span class="op">)</span>, pattern<span class="op">=</span><span class="st">"-"</span>, replacement <span class="op">=</span> <span class="st">"."</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">cibersort_bulk</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">cibersort_bulk</span><span class="op">)</span>, pattern<span class="op">=</span><span class="st">"_"</span>, replacement <span class="op">=</span> <span class="st">"."</span><span class="op">)</span></span>
<span><span class="va">cibersort_bulk</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>genes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">cibersort_bulk</span><span class="op">)</span>, <span class="va">cibersort_bulk</span>, row.names <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cibersort_sc</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/assays.html" class="external-link">normcounts</a></span><span class="op">(</span><span class="va">processed_MCA_PF_SCE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">cibersort_sc</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">cibersort_sc</span><span class="op">)</span>, pattern<span class="op">=</span><span class="st">"-"</span>, replacement <span class="op">=</span> <span class="st">"."</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">cibersort_sc</span><span class="op">)</span> <span class="op">=</span> <span class="va">processed_MCA_PF_SCE</span><span class="op">@</span><span class="va">colData</span><span class="op">$</span><span class="va">pseudotime_bin</span></span>
<span><span class="va">cibersort_sc</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>genes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">cibersort_sc</span><span class="op">)</span>, <span class="va">cibersort_sc</span>, row.names <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/assays.html" class="external-link">normcounts</a></span><span class="op">(</span><span class="va">processed_MCA_PF_SCE</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">processed_MCA_PF_SCE</span><span class="op">@</span><span class="va">colData</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#write.table(cibersort_bulk, file = path(ext_data_dir, "cibersort_bulk_de", ext = "tsv"), sep = "\t", row.names=FALSE, col.names=TRUE)</span></span>
<span><span class="co">#write.table(cibersort_sc, file = path(ext_data_dir, "cibersort_bulk_de", ext = "tsv"), sep = "\t", row.names=FALSE, col.names=TRUE)</span></span></code></pre></div>
<p>After analysing with cibersortx, using default settings, and 100
iterations for confidence, the results are given in this file.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">path_to_cibersort_results</span> <span class="op">=</span> <span class="fu"><a href="https://fs.r-lib.org/reference/path.html" class="external-link">path</a></span><span class="op">(</span><span class="va">ext_data_dir</span>, <span class="st">"CIBERSORTX_Job6_Results"</span>, ext <span class="op">=</span> <span class="st">"csv"</span><span class="op">)</span></span>
<span><span class="va">cibersort_results</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">path_to_cibersort_results</span>, row.names<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu">usethis</span><span class="fu">::</span><span class="fu">use_data</span><span class="op">(</span><span class="va">cibersort_results</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span>, compress <span class="op">=</span> <span class="st">"bzip2"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">cibersort_results</span>, package<span class="op">=</span><span class="st">"blase"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cibersort_results_calls</span> <span class="op">=</span> <span class="va">cibersort_results</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'X1'</span>, <span class="st">'X2'</span>, <span class="st">'X3'</span>, <span class="st">'X4'</span>, <span class="st">'X5'</span>, <span class="st">'X6'</span>, <span class="st">'X7'</span>, <span class="st">'X8'</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">cibersort_results_quality</span> <span class="op">=</span> <span class="va">cibersort_results</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'P.value'</span>, <span class="st">'Correlation'</span>, <span class="st">'RMSE'</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">to_plot</span> <span class="op">=</span> <span class="va">cibersort_results_calls</span></span>
<span><span class="va">to_plot</span><span class="op">$</span><span class="va">BulkID</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">cibersort_results_calls</span><span class="op">)</span></span>
<span><span class="va">to_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html" class="external-link">melt</a></span><span class="op">(</span><span class="va">to_plot</span><span class="op">)</span></span>
<span><span class="co">#&gt; Using BulkID as id variables</span></span>
<span><span class="va">p1</span><span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">to_plot</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">variable</span>, <span class="va">BulkID</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">value</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">value</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"white"</span>, high <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cibersort_results_quality</span></span>
<span><span class="co">#&gt;           P.value Correlation      RMSE</span></span>
<span><span class="co">#&gt; NF54.37.1   0.000   0.5532917 0.8397524</span></span>
<span><span class="co">#&gt; NF54.37.2   0.000   0.6473308 0.7613124</span></span>
<span><span class="co">#&gt; NF54.41.1   0.002   0.4462049 0.8981939</span></span>
<span><span class="co">#&gt; NF54.41.2   0.000   0.5132402 0.8573064</span></span>
<span><span class="co">#&gt; PB4.37.1    0.016   0.2557316 1.0402395</span></span>
<span><span class="co">#&gt; PB4.37.2    0.002   0.4571447 0.9316534</span></span>
<span><span class="co">#&gt; PB4.41.1    0.008   0.3261011 0.9661929</span></span>
<span><span class="co">#&gt; PB4.41.2    0.000   0.5606378 0.8267468</span></span>
<span><span class="co">#&gt; PB31.37.1   0.010   0.2952220 1.0186639</span></span>
<span><span class="co">#&gt; PB31.37.2   0.004   0.3734311 0.9527463</span></span>
<span><span class="co">#&gt; PB31.41.1   0.004   0.3766381 0.9350215</span></span>
<span><span class="co">#&gt; PB31.41.2   0.002   0.4365190 0.9024954</span></span>
<span></span>
<span><span class="va">to_plot</span> <span class="op">=</span> <span class="va">cibersort_results_quality</span></span>
<span><span class="va">to_plot</span><span class="op">$</span><span class="va">BulkID</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">cibersort_results_quality</span><span class="op">)</span></span>
<span><span class="va">to_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html" class="external-link">melt</a></span><span class="op">(</span><span class="va">to_plot</span><span class="op">)</span></span>
<span><span class="co">#&gt; Using BulkID as id variables</span></span>
<span><span class="va">to_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/plyr/man/ddply.html" class="external-link">ddply</a></span><span class="op">(</span><span class="va">to_plot</span>, <span class="fu"><a href="https://rdrr.io/pkg/plyr/man/quoted.html" class="external-link">.</a></span><span class="op">(</span><span class="va">variable</span><span class="op">)</span>, <span class="va">transform</span>, rescale <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/rescale.html" class="external-link">rescale</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p2</span><span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">to_plot</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">variable</span>, <span class="va">BulkID</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">rescale</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">value</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"white"</span>, high <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span></span></code></pre></div>
<p><img src="DE_with_blase_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p2</span></span></code></pre></div>
<p><img src="DE_with_blase_files/figure-html/unnamed-chunk-11-2.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.3.3 (2024-02-29)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 22.04.4 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Random number generation:</span></span>
<span><span class="co">#&gt;  RNG:     Mersenne-Twister </span></span>
<span><span class="co">#&gt;  Normal:  Inversion </span></span>
<span><span class="co">#&gt;  Sample:  Rounding </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats4    stats     graphics  grDevices utils     datasets  methods  </span></span>
<span><span class="co">#&gt; [8] base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt;  [1] reshape2_1.4.4              scales_1.3.0               </span></span>
<span><span class="co">#&gt;  [3] plyr_1.8.9                  ami_0.1.0                  </span></span>
<span><span class="co">#&gt;  [5] blase_0.0.0.9000            scater_1.30.1              </span></span>
<span><span class="co">#&gt;  [7] ggplot2_3.5.0               gridExtra_2.3              </span></span>
<span><span class="co">#&gt;  [9] fs_1.6.3                    BiocParallel_1.36.0        </span></span>
<span><span class="co">#&gt; [11] tradeSeq_1.16.0             slingshot_2.10.0           </span></span>
<span><span class="co">#&gt; [13] TrajectoryUtils_1.10.1      princurve_2.1.6            </span></span>
<span><span class="co">#&gt; [15] scran_1.30.2                scuttle_1.12.0             </span></span>
<span><span class="co">#&gt; [17] SingleCellExperiment_1.24.0 SummarizedExperiment_1.32.0</span></span>
<span><span class="co">#&gt; [19] Biobase_2.62.0              GenomicRanges_1.54.1       </span></span>
<span><span class="co">#&gt; [21] GenomeInfoDb_1.38.7         IRanges_2.36.0             </span></span>
<span><span class="co">#&gt; [23] S4Vectors_0.40.2            BiocGenerics_0.48.1        </span></span>
<span><span class="co">#&gt; [25] MatrixGenerics_1.14.0       matrixStats_1.2.0          </span></span>
<span><span class="co">#&gt; [27] readxl_1.4.3               </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] pbapply_1.7-2             rlang_1.1.3              </span></span>
<span><span class="co">#&gt;  [3] magrittr_2.0.3            compiler_4.3.3           </span></span>
<span><span class="co">#&gt;  [5] mgcv_1.9-1                DelayedMatrixStats_1.24.0</span></span>
<span><span class="co">#&gt;  [7] systemfonts_1.0.6         vctrs_0.6.5              </span></span>
<span><span class="co">#&gt;  [9] stringr_1.5.1             pkgconfig_2.0.3          </span></span>
<span><span class="co">#&gt; [11] crayon_1.5.2              fastmap_1.1.1            </span></span>
<span><span class="co">#&gt; [13] backports_1.4.1           XVector_0.42.0           </span></span>
<span><span class="co">#&gt; [15] labeling_0.4.3            utf8_1.2.4               </span></span>
<span><span class="co">#&gt; [17] rmarkdown_2.26            ggbeeswarm_0.7.2         </span></span>
<span><span class="co">#&gt; [19] ragg_1.3.0                purrr_1.0.2              </span></span>
<span><span class="co">#&gt; [21] xfun_0.42                 bluster_1.12.0           </span></span>
<span><span class="co">#&gt; [23] zlibbioc_1.48.0           cachem_1.0.8             </span></span>
<span><span class="co">#&gt; [25] beachmat_2.18.1           jsonlite_1.8.8           </span></span>
<span><span class="co">#&gt; [27] highr_0.10                DelayedArray_0.28.0      </span></span>
<span><span class="co">#&gt; [29] irlba_2.3.5.1             parallel_4.3.3           </span></span>
<span><span class="co">#&gt; [31] cluster_2.1.6             R6_2.5.1                 </span></span>
<span><span class="co">#&gt; [33] stringi_1.8.3             bslib_0.6.1              </span></span>
<span><span class="co">#&gt; [35] RColorBrewer_1.1-3        limma_3.58.1             </span></span>
<span><span class="co">#&gt; [37] jquerylib_0.1.4           cellranger_1.1.0         </span></span>
<span><span class="co">#&gt; [39] Rcpp_1.0.12               knitr_1.45               </span></span>
<span><span class="co">#&gt; [41] Matrix_1.6-5              splines_4.3.3            </span></span>
<span><span class="co">#&gt; [43] igraph_2.0.3              tidyselect_1.2.1         </span></span>
<span><span class="co">#&gt; [45] abind_1.4-5               yaml_2.3.8               </span></span>
<span><span class="co">#&gt; [47] viridis_0.6.5             codetools_0.2-19         </span></span>
<span><span class="co">#&gt; [49] lattice_0.22-5            tibble_3.2.1             </span></span>
<span><span class="co">#&gt; [51] withr_3.0.0               evaluate_0.23            </span></span>
<span><span class="co">#&gt; [53] desc_1.4.3                pillar_1.9.0             </span></span>
<span><span class="co">#&gt; [55] checkmate_2.3.1           generics_0.1.3           </span></span>
<span><span class="co">#&gt; [57] metR_0.15.0               sparseMatrixStats_1.14.0 </span></span>
<span><span class="co">#&gt; [59] munsell_0.5.0             glue_1.7.0               </span></span>
<span><span class="co">#&gt; [61] metapod_1.10.1            tools_4.3.3              </span></span>
<span><span class="co">#&gt; [63] data.table_1.15.2         BiocNeighbors_1.20.2     </span></span>
<span><span class="co">#&gt; [65] ScaledMatrix_1.10.0       locfit_1.5-9.9           </span></span>
<span><span class="co">#&gt; [67] cowplot_1.1.3             grid_4.3.3               </span></span>
<span><span class="co">#&gt; [69] edgeR_4.0.16              colorspace_2.1-0         </span></span>
<span><span class="co">#&gt; [71] nlme_3.1-164              GenomeInfoDbData_1.2.11  </span></span>
<span><span class="co">#&gt; [73] beeswarm_0.4.0            BiocSingular_1.18.0      </span></span>
<span><span class="co">#&gt; [75] vipor_0.4.7               cli_3.6.2                </span></span>
<span><span class="co">#&gt; [77] rsvd_1.0.5                textshaping_0.3.7        </span></span>
<span><span class="co">#&gt; [79] fansi_1.0.6               S4Arrays_1.2.1           </span></span>
<span><span class="co">#&gt; [81] viridisLite_0.4.2         rematch_2.0.0            </span></span>
<span><span class="co">#&gt; [83] dplyr_1.1.4               gtable_0.3.4             </span></span>
<span><span class="co">#&gt; [85] sass_0.4.8                digest_0.6.35            </span></span>
<span><span class="co">#&gt; [87] ggrepel_0.9.5             SparseArray_1.2.4        </span></span>
<span><span class="co">#&gt; [89] dqrng_0.3.2               farver_2.1.1             </span></span>
<span><span class="co">#&gt; [91] memoise_2.0.1             htmltools_0.5.7          </span></span>
<span><span class="co">#&gt; [93] pkgdown_2.0.7             lifecycle_1.0.4          </span></span>
<span><span class="co">#&gt; [95] statmod_1.5.0</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Andrew McCluskey, Toby Kettlewell, Thomas Otto.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
