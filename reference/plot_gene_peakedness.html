<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>plot_gene_peakedness — plot_gene_peakedness • blase</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="plot_gene_peakedness — plot_gene_peakedness"><meta name="description" content="plot_gene_peakedness"><meta property="og:description" content="plot_gene_peakedness"><meta property="og:image" content="https://andrewmccluskey-uog.github.io/BLASE/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">blase</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><h6 class="dropdown-header" data-toc-skip>Vignettes</h6></li>
    <li><a class="dropdown-item" href="../articles/How-Blase-Works.html">How BLASE Works</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>plot_gene_peakedness</h1>

      <div class="d-none name"><code>plot_gene_peakedness.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>plot_gene_peakedness</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_gene_peakedness</span><span class="op">(</span></span>
<span>  <span class="va">sce</span>,</span>
<span>  <span class="va">gene_peakedness_df</span>,</span>
<span>  <span class="va">gene</span>,</span>
<span>  pseudotime_slot <span class="op">=</span> <span class="st">"slingPseudotime_1"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-sce">sce<a class="anchor" aria-label="anchor" href="#arg-sce"></a></dt>
<dd><p>Single Cell Experiment to plot gene from. Must contain pseudotime,
and normcounts</p></dd>


<dt id="arg-gene-peakedness-df">gene_peakedness_df<a class="anchor" aria-label="anchor" href="#arg-gene-peakedness-df"></a></dt>
<dd><p>The DataFrame Result of <code>calculate_gene_peakedness</code></p></dd>


<dt id="arg-gene">gene<a class="anchor" aria-label="anchor" href="#arg-gene"></a></dt>
<dd><p>The gene to plot. Must be present in the SCE and
gene_peakedness_df</p></dd>


<dt id="arg-pseudotime-slot">pseudotime_slot<a class="anchor" aria-label="anchor" href="#arg-pseudotime-slot"></a></dt>
<dd><p>The pseudotime slot in the SCE object.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A ggplot2 plot showing: in black points, expression of the gene
over pseudotime, in a green line, the fitted expression of the gene over
pseudotime, the inside and outside of window means of smoothed expression
(red and blue dotted horizotal lines respectively), and the bounds of the
window (in black dotted vertical lines).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">ncells</span> <span class="op">&lt;-</span> <span class="fl">70</span></span></span>
<span class="r-in"><span><span class="va">ngenes</span> <span class="op">&lt;-</span> <span class="fl">100</span></span></span>
<span class="r-in"><span><span class="va">counts_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">3500</span><span class="op">)</span> <span class="op">/</span> <span class="fl">10</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">3500</span><span class="op">)</span> <span class="op">/</span> <span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  ncol <span class="op">=</span> <span class="va">ncells</span>,</span></span>
<span class="r-in"><span>  nrow <span class="op">=</span> <span class="va">ngenes</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu">SingleCellExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/SingleCellExperiment.html" class="external-link">SingleCellExperiment</a></span><span class="op">(</span>assays <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  counts <span class="op">=</span> <span class="va">counts_matrix</span> <span class="op">*</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>  normcounts <span class="op">=</span> <span class="va">counts_matrix</span>,</span></span>
<span class="r-in"><span>  logcounts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">counts_matrix</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">sce</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"cell"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">ncells</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">sce</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"gene"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">ngenes</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sce</span><span class="op">$</span><span class="va">cell_type</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"celltype_1"</span>, <span class="va">ncells</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"celltype_2"</span>, <span class="va">ncells</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">sce</span><span class="op">$</span><span class="va">pseudotime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">ncells</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">genelist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">sce</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># calculate_gene_peakedness</span></span></span>
<span class="r-in"><span><span class="va">gene_peakedness</span> <span class="op">&lt;-</span> <span class="fu"><a href="calculate_gene_peakedness.html">calculate_gene_peakedness</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">sce</span>, pseudotime_slot<span class="op">=</span><span class="st">"pseudotime"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">gene_peakedness</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       gene peak_pseudotime mean_in_window mean_out_window    ratio window_start</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 100  gene1              70          650.2        231.2076 2.812192         66.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1001 gene2              70          650.4        231.3545 2.811270         66.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1002 gene3              70          650.6        231.5015 2.810349         66.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1003 gene4              70          650.8        231.6485 2.809429         66.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1004 gene5              70          651.0        231.7955 2.808511         66.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1005 gene6              70          651.2        231.9424 2.807593         66.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      window_end deviance_explained</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 100        73.5          0.9608241</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1001       73.5          0.9608646</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1002       73.5          0.9609050</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1003       73.5          0.9609454</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1004       73.5          0.9609857</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1005       73.5          0.9610260</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot_gene_peakedness</span></span></span>
<span class="r-in"><span><span class="fu">plot_gene_peakedness</span><span class="op">(</span><span class="va">sce</span>, <span class="va">gene_peakedness</span>, <span class="st">"gene20"</span>,</span></span>
<span class="r-in"><span>  pseudotime_slot <span class="op">=</span> <span class="st">"pseudotime"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_gene_peakedness-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># smooth_gene</span></span></span>
<span class="r-in"><span><span class="va">smoothed_gene20</span> <span class="op">&lt;-</span> <span class="fu"><a href="smooth_gene.html">smooth_gene</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">sce</span>, <span class="st">"gene20"</span>, pseudotime_slot <span class="op">=</span> <span class="st">"pseudotime"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">smoothed_gene20</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        1        2        3        4        5        6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18.65217 21.10711 23.88086 27.00601 30.51590 34.44399 </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Andrew McCluskey, Toby Kettlewell, Thomas Otto.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

