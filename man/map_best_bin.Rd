% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mapping.R
\name{map_best_bin}
\alias{map_best_bin}
\title{Map the best matching SC bin for a bulk sample}
\usage{
map_best_bin(atgnat_data, bulk_id, bulk_data)
}
\arguments{
\item{atgnat_data}{The \link{AtgnatData} holding the bins.}

\item{bulk_id}{The sample id of the bulk to analyse}

\item{bulk_data}{The whole bulk read matrix}
}
\value{
A \link{MappingResult} object.
}
\description{
Map the best matching SC bin for a bulk sample
}
\examples{
counts_matrix <- matrix(c(rep(1, 100), rep(2, 100)), ncol=50, nrow=4)
sce <- SingleCellExperiment::SingleCellExperiment(assays=list(normcounts=counts_matrix))
colnames(sce) = seq_len(cells)
sce$cell_type = c(rep(1, "celltype_1"), rep(2, "celltype_2"))

atgnat_data = as.AtgnatData(sce)

bulk_counts = matrix(rep(1, 3*genes), ncol=3, nrow=genes)
colnames(bulk_counts) = c("A", "B", "C")
result = map_best_bin(atgnat_data, "B", bulk_counts)
result
plot_mapping_result(sce, result, group_by_slot="cell_type")
}
\concept{mapping}
