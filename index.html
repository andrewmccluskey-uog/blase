<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Bulk Linking Analysis for Single-cell Experiments • blase</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" sizes="any" href="favicon.ico">
<link rel="manifest" href="site.webmanifest">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Bulk Linking Analysis for Single-cell Experiments">
<meta name="description" content="Find where bulk RNA-seq data lies on a single-cell pseudotime trajectory. Uses a fast, understandable correlation based approach. Can be used to improve bulk DE, or understand real timepoints in SC from timeseries bulk data.">
<meta property="og:description" content="Find where bulk RNA-seq data lies on a single-cell pseudotime trajectory. Uses a fast, understandable correlation based approach. Can be used to improve bulk DE, or understand real timepoints in SC from timeseries bulk data.">
<meta property="og:image" content="https://andrewmccluskey-uog.github.io/BLASE/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">blase</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><h6 class="dropdown-header" data-toc-skip>Vignettes</h6></li>
    <li><a class="dropdown-item" href="articles/How-Blase-Works.html">How BLASE Works</a></li>
    <li><a class="dropdown-item" href="articles/assign-bulk-to-pseudotime.html">Assigning Bulk to Pseudotime</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>Articles</h6></li>
    <li><a class="dropdown-item" href="articles/BLASE-for-annotating-scRNA-seq.html">BLASE for annotating scRNA-seq</a></li>
    <li><a class="dropdown-item" href="articles/BLASE-for-excluding-developmental-genes-from-bulk-RNA-seq.html">BLASE for excluding developmental genes from bulk RNA-seq</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="blase-bulk-linking-analysis-for-single-cell-experiments-">BLASE: Bulk Linking Analysis for Single-cell Experiments 
<a class="anchor" aria-label="anchor" href="#blase-bulk-linking-analysis-for-single-cell-experiments-"></a>
</h1>
</div>
<!-- badges: start -->

<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The goal of BLASE is to enable you to map bulk RNA-seq samples onto Single Cell RNA-seq for further analysis, with an emphasis on trajectories (but it can work for any continuous variable across your data!).</p>
<p>It provides:</p>
<ul>
<li>Configurable discretisation of pseudotime into “pseudotime bins”</li>
<li>A custom “Gene Peakedness” method for identifying temporally variable genes</li>
<li>Annotation of scRNA-seq based on bulk samples</li>
<li>Mapping of bulk RNA-seq onto these bins.</li>
<li>Plotting functions</li>
</ul>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of BLASE from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"andrewmccluskey-uog/BLASE"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="getting-started--usage-notes">Getting Started &amp; Usage Notes<a class="anchor" aria-label="anchor" href="#getting-started--usage-notes"></a>
</h2>
<p>Take a look at the Vignette for use with a Single Cell Experiment.</p>
<p>Selection of genes is important for BLASE, as it will base any predictions on the expression of these genes only. Any genes omitted from this list will be ignored. Selecting too few genes reduces BLASE’s ability to dissect different stages from each other. Conversely, a number of genes that is too great (i.e. introducing genes which do not have expression changes over the biological process) only introduces noise, reducing BLASE’s precision. Ideally, these genes should be only those which show substantial change over the pseudotime trajectory in the single-cell reference that one would wish to map to.</p>
<p>For cases of organisms with many genes that are highly expressed for a period over the biological process in a highly regulated way (for example, Plasmodium spp.), we recommend using every gene in the genome.</p>
<p>For organisms which do not show this pattern, such as human or mouse, we recommend using a subset of genes, selected by either TradeSeq or BLASE’s gene peakedness selection. In order to make this process easier for users of BLASE, we provide a function <code><a href="reference/get_top_n_genes.html">get_top_n_genes()</a></code> which enables simple selection of a certain number of genes from an associationTest result generated by the <code>TradeSeq</code> package, and convenience functions for calculating the gene peakedness as described here.</p>
<p>Each reference scRNA-seq trajectory will have a unique fingerprint, defined by genes activated over the course of the process. To optimally use BLASE, it is important to consider how many genes will meaningfully contribute to the fingerprint of the process, as well as how many bins should be used to balance accuracy and precision. When selecting the number of genes to use, it is important to select genes which can be used meaningfully to describe the trajectory. Too few genes risks useful signal being lost, however too many genes may introduce unhelpful noise. When selecting the number of bins to use, there is a trade-off between using a small number of larger bins, which can give very accurate (i.e. correct call) readings, and a larger number of bins which gives the desired precision (i.e. more granularity).</p>
<p>BLASE uses a discretised pseudotime value, which we refer to as “pseudotime bins.” BLASE will calculate these bins when creating a BlaseData object, or when using the <code><a href="reference/assign_pseudotime_bins.html">assign_pseudotime_bins()</a></code> function to add these to the metadata of SingleCellExperiment or Seurat object. Because the BLASE algorithm relies heavily on these bins, it is important to have a reliable and consistent method to split these. Depending on the dataset, different methods may be required to ensure high-quality mappings. We have found that using the <code>pseudotime_range</code> splitting method works best for most datasets.</p>
<p>The pseudotime range bin assignment method is fast, and (assuming correctness of the pseudotime calculation) implies that each bin will have a constant transcriptional distance between each other, given the assumption that the method to generate the pseudotime accounts for this. However, this method may perform poorly when a reference dataset contains stretches of pseudotime with no or very few cells in it. In this case, splitting by cells may be a better option. When assigning bins to contain a constant number of cells, the pseudotime range covered by each group is not constant, and may be less useful for mapping purposes, but can overcome some of the issues with the pseudotime range method.</p>
<p>BLASE’s main focus is on mapping RNA-seq samples to the discretised pseudotime in a scRNA-seq dataset. Unlike other tools (e.g. CIBERSORTx, DWLS, MuSiC) which estimate a proportion of cells per reference group (typically cell type), BLASE calculates a score for how well each reference group (for BLASE, typically a pseudotime bin) matches a sample, and giving only a single “best match,” and the correlations for all other bins. These values produced by BLASE should not necessarily be treated as proportions of the population in the bulk sample.</p>
</div>
<div class="section level2">
<h2 id="development">Development<a class="anchor" aria-label="anchor" href="#development"></a>
</h2>
<div class="section level3">
<h3 id="automatic-style-corrections">Automatic Style Corrections<a class="anchor" aria-label="anchor" href="#automatic-style-corrections"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>styler<span class="sc">::</span><span class="fu">style_pkg</span>(<span class="at">transformers =</span> styler<span class="sc">::</span><span class="fu">tidyverse_style</span>(<span class="at">indent_by =</span> <span class="dv">4</span>))</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="quality-checks">Quality Checks<a class="anchor" aria-label="anchor" href="#quality-checks"></a>
</h3>
<p>We subscribe to the <code>R cmd check</code> and <code>BiocCheck</code> guides:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">check</span>()</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="fu">BiocCheck</span>(<span class="st">`</span><span class="at">no-check-deprecated</span><span class="st">`</span><span class="ot">=</span><span class="cn">TRUE</span>)</span></code></pre></div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://andrewmccluskey-uog.github.io/BLASE/issues">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing blase</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Andrew McCluskey <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0009-0004-4187-799X" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li>Toby Kettlewell <br><small class="roles"> Author </small>   </li>
<li>Thomas Otto <br><small class="roles"> Author, thesis advisor </small> <a href="https://orcid.org/0000-0002-1246-7404" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/andrewmccluskey-uog/BLASE/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/andrewmccluskey-uog/BLASE/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Andrew McCluskey, Toby Kettlewell, Thomas Otto.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
